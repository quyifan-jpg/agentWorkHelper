syntax = "v1"

type (
    ChatReq {
        Prompts    string   `json:"prompts,omitempty"`
        ChatType   int      `json:"chatType,omitempty"`
        RelationId string      `json:"relationId,omitempty"`
        StartTime   int64   `json:"startTime,omitempty"`
        EndTime     int64   `json:"endTime,omitempty"`
    }
    ChatResp {
        ChatType    int            `json:"chatType,omitempty"`
        Data        interface{}    `json:"data"`
    }
    // FileResp 文件上传响应结构
    FileResp {
            Host        string      `json:"host"`    // 文件访问主机地址
            File        string      `json:"file"`    // 文件相对路径
            Filename    string      `json:"filename"` // 文件名称
    }
    // FileListResp 多文件上传响应结构
    FileListResp {
        List []*FileResp    `json:"list"` // 文件列表
    }
)

@server(
    group: v1/chat
    logic: Chat
    middleware: Jwt
)
service chat {
    @server(
        handler: Chat
        logic: Chat.AIChat
    )
    post /(ChatReq) returns(ChatResp)
}

// 文件上传服务定义
@server(
    group: v1/upload
    logic: Chat
    middleware: Jwt // 使用JWT中间件保护上传接口
)
service Upload {
    @server(
        handler: File
        name: 上传单个文件
        logic: Chat.File // 处理文件上传并将文件信息写入记忆机制
    )
    post /file returns(FileResp)

    @server(
        handler: Multiplefiles
        name: 批量上传文件
    )
    post /multiplefiles returns(FileListResp)
}